REPORT Z_RESTFUL_JSON.

DATA: JSON_SER TYPE REF TO CL_TREX_JSON_SERIALIZER,
      JSON_DES TYPE REF TO CL_TREX_JSON_DESERIALIZER.

DATA: LV_URL TYPE STRING."http 服务接口地址
DATA: LO_HTTP_CLIENT  TYPE REF TO IF_HTTP_CLIENT.

DATA: LV_LEN TYPE I."发送报文长度
DATA: LV_RESPON TYPE STRING.
DATA: LV_SUBRC TYPE SY-SUBRC.
DATA: LV_JSON_STR TYPE STRING. "发送报文
DATA: LV_MSGTY TYPE C,
      LV_MSGTX TYPE STRING.

DATA: LT_JSON TYPE STANDARD TABLE OF VBAK,
      LS_JSON TYPE VBAK.

* 设置HTTP接口地址
LV_URL = 'http://192.168.37.1:8888/aomei'.


"实例化1个 IF_HTTP_CLIENT 的对象得到HTTP_CLIENT
CL_HTTP_CLIENT=>CREATE_BY_URL(
           EXPORTING URL    = LV_URL                "输入参数
           IMPORTING CLIENT = LO_HTTP_CLIENT ).

"设置某个特定的header field的值
LO_HTTP_CLIENT->REQUEST->SET_HEADER_FIELD(
        EXPORTING
             NAME  = '~SERVER_PROTOCOL'
             VALUE = 'HTTP/1.1' ).

"设置某个特定的header field的值
CALL METHOD LO_HTTP_CLIENT->REQUEST->SET_HEADER_FIELD
  EXPORTING
    NAME  = 'CONTENT-TYPE'
    VALUE = 'APPLICATION/XML'.

"设置某个特定的header field的值
LO_HTTP_CLIENT->REQUEST->SET_HEADER_FIELD(
      EXPORTING
           NAME  = 'ACCEPT'
           VALUE = '*/*' ).
"设置http请求的方法GET 或者 POST
CALL METHOD LO_HTTP_CLIENT->REQUEST->SET_METHOD( 'GET' ).
"设置http body
DATA S_BODYDATA TYPE STRING VALUE 'ABC'.
CALL METHOD lo_HTTP_CLIENT->REQUEST->SET_CDATA
  EXPORTING
    DATA = S_BODYDATA.                             "输入参数
"dispatch of data
CALL METHOD LO_HTTP_CLIENT->SEND
  EXCEPTIONS
    HTTP_COMMUNICATION_FAILURE = 1
    HTTP_INVALID_STATE         = 2.

IF SY-SUBRC EQ 0.
  MESSAGE I001(00) WITH 'OK'.
ENDIF.
"receipt of http response
CALL METHOD LO_HTTP_CLIENT->RECEIVE
  EXCEPTIONS
    HTTP_COMMUNICATION_FAILURE = 1
    HTTP_INVALID_STATE         = 2
    HTTP_PROCESSING_FAILED     = 3.

CASE  SY-SUBRC .
  WHEN 1.
  WHEN 2.
  WHEN 3.
  WHEN OTHERS.
ENDCASE.

"获取response中的http的body内容
DATA S_RETURN TYPE STRING.
S_RETURN = LO_HTTP_CLIENT->RESPONSE->GET_CDATA( ).  "执行结果
WRITE S_RETURN.
"关闭http链接
CALL METHOD LO_HTTP_CLIENT->CLOSE.