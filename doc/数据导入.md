
<table border="1" cellspacing="0" cellpadding="0">
  <tr>
    <td  colspan="2" valign="top">
			 
			
			
			数据导入
			
			
			
			 
	</td>
  </tr>
  <tr>
    <td  valign="top"><p>过程</p></td>
    <td  valign="top"><p>过程描述</p></td>
  </tr>
  <tr>
    <td  colspan="2" valign="top">
		 
		
		
		
		
		
		
		
			___________________________________________过程描述_____________________________________________________
			
			
			
			
			
			
				**1、显示界面**
				![](http://upload-images.jianshu.io/upload_images/6098829-79dedf212cd6bb20.gif?imageMogr2/auto-orient/strip)

				---
				2、代码
				``` abap
					
*&------------------------------------------------------------------*
*& Report Y1722150_FILE
*&------------------------------------------------------------------*
*&
*&------------------------------------------------------------------*
REPORT Y1722150_FILE.

PARAMETERS:P_FILE LIKE RLGRAP-FILENAME OBLIGATORY .

DATA: IL_RAW TYPE TRUXS_T_TEXT_DATA.
DATA:L_OBJ TYPE REF TO CL_GUI_FRONTEND_SERVICES.
DATA: IT_FILE TYPE FILETABLE WITH HEADER LINE.
DATA: G_RC        TYPE I,
      USER_ACTION TYPE I VALUE 0.

TYPES: BEGIN OF GTY_DATA,
         c(4),
         n(10) TYPE N,
         I     TYPE I,
         D     TYPE D,
       END OF GTY_DATA.

DATA :GS_DATA TYPE GTY_DATA,
      GT_DATA TYPE STANDARD TABLE OF GTY_DATA.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR P_FILE. "弹出选择文件对话框

  CREATE OBJECT L_OBJ.

  CALL METHOD L_OBJ->FILE_OPEN_DIALOG
    EXPORTING
*     WINDOW_TITLE      =
*     DEFAULT_EXTENSION =
*     DEFAULT_FILENAME  =
      FILE_FILTER = 'Excel|*.xls;*.xlsx|TXT|*.txt|'
*     WITH_ENCODING     =
*     INITIAL_DIRECTORY = 'C:\temp\data'
*     MULTISELECTION    =
    CHANGING
      FILE_TABLE  = IT_FILE[]
      RC          = G_RC.
  USER_ACTION           = USER_ACTION
*    FILE_ENCODING          =
*  EXCEPTIONS
*    FILE_OPEN_DIALOG_FAILED = 1
*    CNTL_ERROR              = 2
*    ERROR_NO_GUI            = 3
*    NOT_SUPPORTED_BY_GUI    = 4
*    OTHERS                  = 5
.
  IF SY-SUBRC <> 0.
* Implement suitable error handling here
  ENDIF.

  READ TABLE IT_FILE INDEX 1.
  P_FILE = IT_FILE-FILENAME.

START-OF-SELECTION.

  CALL FUNCTION 'TEXT_CONVERT_XLS_TO_SAP' "可以是Excel文件，也可以是Txt文件
    EXPORTING
*     I_FIELD_SEPERATOR    = 分隔符，默认为Tab
*     i_line_header        = 'X' "文本中的第一行是否是标题头，如果是则不会读取
      I_TAB_RAW_DATA       = IL_RAW "该参数实际上没有使用到，但为必输参数
      I_FILENAME           = P_FILE
    TABLES
      I_TAB_CONVERTED_DATA = GT_DATA. "会自动的将Excel、Txt文件中的数据一行行读取到数据内表中

  LOOP AT GT_DATA INTO GS_DATA.

  ENDLOOP.

				```
				
				
				
				
				
				
				
				
				
			___________________________________________过程描述_____________________________________________________
				
				
			
		</p>
	</td>
  </tr>
  <tr>
    <td  valign="top">
		<p>知识点</p>
	</td>
    <td  valign="top">
		<p>&nbsp;</p>
	</td>
  </tr>
  <tr>
    <td  colspan="2" valign="top">
		<p>
		
		
		
		
		
		
		
		
			___________________________________________过程描述_____________________________________________________
			1、文件数据转换：TEXT_CONVERT_XLS_TO_SAP
			2、获取文件路径CL_GUI_FRONTEND_SERVICES =》FILE_OPEN_DIALOG

			___________________________________________过程描述_____________________________________________________
			
			
			
			
			
			
			
			
			
		 
	</td>
  </tr>
</table>